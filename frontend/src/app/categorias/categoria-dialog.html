<div class="modern-dialog">
  <h2 mat-dialog-title>
    <mat-icon>category</mat-icon>
    {{ isEdit ? 'Editar Categoria' : 'Nova Categoria' }}
  </h2>

  <mat-dialog-content>
    <form [formGroup]="categoriaForm" class="modern-form">
      <div class="form-row single">
        <mat-form-field appearance="outline">
          <mat-label>Nome da Categoria</mat-label>
          <input matInput 
                 formControlName="nome" 
                 placeholder="Ex: Alimentação, Transporte, Lazer">
          <mat-icon matSuffix>label</mat-icon>
          <mat-error *ngIf="categoriaForm.get('nome')?.hasError('required')">
            Nome é obrigatório
          </mat-error>
          <mat-error *ngIf="categoriaForm.get('nome')?.hasError('minlength')">
            Nome deve ter pelo menos 2 caracteres
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row single">
        <mat-form-field appearance="outline">
          <mat-label>Valor Provisionado Mensal</mat-label>
          <input matInput 
                 type="text" 
                 formControlName="valorProvisionadoMensal" 
                 placeholder="300,00"
                 (input)="onCurrencyInput($event, 'valorProvisionadoMensal')"
                 (blur)="onCurrencyBlur($event, 'valorProvisionadoMensal')">
          <span matTextPrefix>R$ </span>
          <mat-icon matSuffix>account_balance_wallet</mat-icon>
          <mat-hint>Valor que você planeja gastar mensalmente nesta categoria</mat-hint>
          <mat-error *ngIf="categoriaForm.get('valorProvisionadoMensal')?.hasError('required')">
            Valor provisionado é obrigatório
          </mat-error>
          <mat-error *ngIf="categoriaForm.get('valorProvisionadoMensal')?.hasError('min')">
            Valor deve ser maior ou igual a zero
          </mat-error>
        </mat-form-field>
        <div class="value-suggestions">
          <span class="suggestion-chip" (click)="setValorProvisionadoMensal(100)">R$ 100,00</span>
          <span class="suggestion-chip" (click)="setValorProvisionadoMensal(300)">R$ 300,00</span>
          <span class="suggestion-chip" (click)="setValorProvisionadoMensal(500)">R$ 500,00</span>
          <span class="suggestion-chip" (click)="setValorProvisionadoMensal(1000)">R$ 1.000,00</span>
        </div>
      </div>

      <div class="form-row single">
        <mat-form-field appearance="outline">
          <mat-label>Descrição (Opcional)</mat-label>
          <textarea matInput 
                    formControlName="descricao" 
                    placeholder="Detalhes sobre esta categoria..."
                    rows="3"></textarea>
          <mat-icon matSuffix>description</mat-icon>
          <mat-hint>Informações adicionais sobre a categoria</mat-hint>
        </mat-form-field>
      </div>

      <div class="form-row single">
        <mat-checkbox formControlName="ativa" color="primary">
          Categoria ativa
        </mat-checkbox>
        <div class="custom-hint">
          Categorias inativas não aparecerão nas opções de lançamentos
        </div>
      </div>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()" [disabled]="isLoading">
      Cancelar
    </button>
    <button mat-raised-button 
            color="primary" 
            (click)="onSave()" 
            [disabled]="!categoriaForm.valid || isLoading">
      <mat-spinner diameter="20" *ngIf="isLoading"></mat-spinner>
      <span *ngIf="!isLoading">{{ isEdit ? 'Atualizar' : 'Criar' }}</span>
    </button>
  </mat-dialog-actions>
</div>
